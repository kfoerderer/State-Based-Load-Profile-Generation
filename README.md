# State-based load profile generation for modeling energetic flexibility

This is the official repository for the paper [State-based load profile generation for modeling energetic flexibility](https://doi.org/10.1186/s42162-019-0077-z)


|Abbreviation|Meaning|
|-|-|
|ANN|Artificial neural network|
|BESS|Battery energy storage system|
|CHP plant|Combined heat and power plant|
|DER|Distributed energy resource. A source for energetic [flexibility](https://publikationen.bibliothek.kit.edu/1000077040), e.g., a BESS.|
|HWT|Hot water tank|

## Structure

This repository is structured as follows:

- __data__
  - Time series for household consumption
- __experiments__
    - __bess__ / __bess_chp_hwt__ / __chp_hwt__: DER configuration
      - __classifier__: Output directory for _classifier_ training runs
      - __transition__: Output direcoty for _state estimator_ training runs
      - Jupyter Notebooks for training and evaluating ANNS
- __simulation/systems__
  -  DER simulation models

## Environment

The code found in this repository has most recently been executed in [this conda environment](environment).
Please note that we upgraded the package versions compared to those used in the paper. 
However, the results are still exactly reproducable.

### Jupyter lab

When using jupyter lab please make sure to install _jupyter-widgets/jupyterlab-manager_:
    
    jupyter labextension install @jupyter-widgets/jupyterlab-manager

### CUDA

We used GPUs to speed up the training process. For running the code on a CPU, please remove the .cuda() calls in the code.

## Evaluation Output / Results

A discussion of the results can be found in the paper. Here we provide the (raw) output generated by the scripts and trained models. 
To generate these results yourself, run the jupyter notebooks and ommit the two cells for training the two neural models. 
The trained neural models that generated the results are included in the repository and loaded by the evaluation code.
Make sure to check the configuration, e.g., buffers, and adapt it if necessary.

### BESS

    with confidence 0.950000
    false positives: 3018, 0.000156
    false negatives: 80416, 0.004167
    correctly classified: 19212566, 0.995676

    Generated 983 feasible profiles

### CHP with HWT

Without buffers

    buffers {'min_staying_time': (0, 0), 'min_charge': 0, 'max_charge': 0}
    with confidence 0.950000
    false positives: 1927, 0.010036
    false negatives: 8250, 0.042969
    correctly classified: 181823, 0.946995

    Generated 520 feasible profiles
    Number of feasible profiles when neglecting min and max SOC of HWT: 953

With buffers of 0.05

    buffers {'min_staying_time': (0, 0), 'min_charge': 0.05, 'max_charge': -0.05}
    with confidence 0.950000
    false positives: 63, 0.000328
    false negatives: 24992, 0.130167
    correctly classified: 166945, 0.869505

    Generated 951 feasible profiles
    Number of feasible profiles when neglecting min and max SOC of HWT: 992

With buffers of 0.1

    buffers {'min_staying_time': (0, 0), 'min_charge': 0.1, 'max_charge': -0.1}
    with confidence 0.950000
    false positives: 0, 0.000000
    false negatives: 37976, 0.197792
    correctly classified: 154024, 0.802208

    Generated 996 feasible profiles
    Number of feasible profiles when neglecting min and max SOC of HWT: 998


### BESS and CHP with HWT

Without buffers

    buffers {'min_staying_time': (0, 0), 'min_charge': 0, 'max_charge': 0}
    with confidence 0.950000
    false positives: 324687, 0.008413
    false negatives: 3015651, 0.078142
    correctly classified: 35251662, 0.913445

    Generated 512 feasible profiles
    Number of feasible profiles when neglecting min and max SOC of HWT: 960


With buffers of 0.05

    buffers {'min_staying_time': (0, 0), 'min_charge': 0.05, 'max_charge': -0.05}
    with confidence 0.950000
    false positives: 6265, 0.000162
    false negatives: 6002513, 0.155538
    correctly classified: 32583222, 0.844300

    Generated 967 feasible profiles
    Number of feasible profiles when neglecting min and max SOC of HWT: 992

With buffers of 0.1

    buffers {'min_staying_time': (0, 0), 'min_charge': 0.1, 'max_charge': -0.1}
    with confidence 0.950000
    false positives: 372, 0.000010
    false negatives: 8164451, 0.211558
    correctly classified: 30427177, 0.788432

    Generated 988 feasible profiles
    Number of feasible profiles when neglecting min and max SOC of HWT: 991
